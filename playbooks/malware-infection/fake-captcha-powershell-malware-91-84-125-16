## Fake reCAPTCHA → Fileless PowerShell Malware
##### Author: Regan Temudo  
##### Type: Threat Intelligence / Malware Research  
##### Status: Active campaign observed in the wild

### Threat Class
Social Engineering · Fileless Malware · PowerShell Loader

### Severity
**High** (User-driven execution + in-memory payload)

---

## 1️ - Detection & Identification

### Primary Detection Signals
- User reports a CAPTCHA asking for **Windows + R / PowerShell**
- PowerShell execution with:
  - `-enc`
  - `Invoke-Expression`
  - `wget`, `curl`, `Invoke-WebRequest`
- Outbound HTTP traffic to suspicious IPs
- ScriptBlock Logging (Event ID **4104**)

### Example Detection Queries
- PowerShell command line contains:
```

powershell -enc
iex
Invoke-Expression

```
- Network traffic to:
```

91.84.125.16

```
---

## 2️ - Initial Triage (First 15 Minutes)

### Analyst Actions
- Confirm user interaction occurred
- Identify affected endpoint(s)
- Capture:
- Hostname
- Username
- Timestamp
- Source URL
- Do NOT re-execute payload 
- Do NOT power off system yet

### Decision Point
If PowerShell execution is confirmed → **Escalate to Incident**

---

## 3️ - Containment

### Endpoint Containment
- Isolate endpoint from network (EDR / NAC)
- Disable user account temporarily
- Block PowerShell execution for non-admin users

### Network Containment
- Block IOC IPs and domains at:
- Firewall
- Proxy
- DNS
- Monitor for lateral movement

---

## 4️ - Investigation & Analysis

### Host-Based Analysis
- Review PowerShell logs:
- Event ID 4104 (ScriptBlock)
- Event ID 4688 (Process creation)
- Check for:
- AMSI bypass attempts
- Persistence mechanisms (Run keys, Scheduled Tasks)
- Memory analysis if possible

### Network Analysis
- Identify additional hosts contacting:
```

/big.txt

````
- Review proxy logs for fake CAPTCHA pages

---

## 5️ - Eradication

### Required Actions
- Reimage affected endpoint(s)
- Rotate credentials for impacted users
- Remove persistence artifacts (if found)
- Clear cached PowerShell profiles

### Validation
- Confirm no outbound traffic to known IOCs
- Confirm no new PowerShell executions post-remediation

---

## 6️ - Recovery

### System Restoration
- Restore endpoint from clean image
- Re-enable user account with new credentials
- Monitor system for 48–72 hours

### Business Validation
- Confirm no data exfiltration indicators
- Validate normal user operations

---

## 7️ - Post-Incident Actions

### Lessons Learned
- Document infection vector
- Identify why user trusted fake CAPTCHA
- Review browser security controls

### Preventive Controls
- Disable PowerShell where not required
- Enforce:
- Constrained Language Mode
- AMSI + ScriptBlock Logging
- Add user awareness training:
> “CAPTCHA never requires keyboard commands”

---

## 8️ - Indicators of Compromise (IOCs)

```text
IP: 91.84.125.16
Path: /big.txt
Command: powershell -enc
Technique: Fake reCAPTCHA social engineering
````

---

## 9️ - MITRE ATT&CK Mapping

| Tactic            | Technique                 |
| ----------------- | ------------------------- |
| Initial Access    | T1566 (Phishing)          |
| Execution         | T1059.001 (PowerShell)    |
| Defense Evasion   | T1027 (Obfuscation)       |
| Command & Control | T1071.001 (Web Protocols) |

---

## 10️ -  Summary

This incident leverages **human trust**, not software flaws.
Prevention depends on **user awareness + PowerShell control**, not patching.

---

### Owner

SOC / Blue Team

### Review Cycle

Quarterly or after new campaign sightings

