# ü¶† Malware Samples ‚Äî Analysis & Collection Notes

> ‚ö†Ô∏è All files in this directory with `.php.sample` extension are **defanged** ‚Äî renamed to prevent execution. For analysis purposes only. See [DISCLAIMER.md](../../DISCLAIMER.md).

---

## Collection Overview

These samples were collected via open-source threat intelligence (OSINT) from publicly observable attacker infrastructure. No samples were obtained through unauthorized access. Collection methodology includes:

- Shodan / Censys scanning of exposed directories
- VirusTotal threat feed correlation
- Honeypot telemetry
- Threat actor infrastructure monitoring

---

## Sample Index

### `cache.php.sample` ‚Äî PHP Web Shell (Full-Featured File Manager)
- **Type:** PHP Web Shell
- **Capability:** Full server file manager, terminal emulator, database browser, mass WordPress compromise, cPanel token theft
- **Notable Features:** Multi-method command execution fallback chain, WordPress mass-admin deployment, security plugin kill logic (Wordfence, iThemes, Sucuri), mass credential harvesting
- **C2 Callback:** `stepmomhub[.]com/wp/receiver.php`
- **Attacker Handle:** `xshikata`
- **Detection:** Look for `root@xshikata` in HTTP responses; `create_wp_admin` POST parameters; outbound traffic to receiver URL
- **MITRE:** T1505.003 (Web Shell), T1078 (Valid Accounts), T1136 (Create Account)

---

### `shadow-bot.php.sample` ‚Äî PHP Web Shell (Encrypted Loader + Shell)
- **Type:** PHP Web Shell with AES-256-CBC encrypted payload
- **Capability:** File management, remote command execution, database access
- **Obfuscation:** AES-256-CBC encrypted payload decoded from `$_REQUEST["k"]`; encrypted strings throughout
- **VirusTotal Hash:** `365f2f4de5ac872ce5a1fe6fbbf382b936c1defc6d767a37f69b5df4188d9522`
- **Associated Infrastructure:** `5.9.228[.]188:5000` (Shadow C2 Panel)
- **Detection:** Encrypted `$_REQUEST["k"]` parameter check; `openssl_decrypt` in PHP source; outbound to port 5000
- **MITRE:** T1505.003 (Web Shell), T1027 (Obfuscated Files/Information), T1140 (Deobfuscate/Decode)

---

### `cleavable.php.sample` ‚Äî Obfuscated PHP Loader
- **Type:** Multi-stage PHP loader / dropper
- **Capability:** Fetches and executes remote PHP code; acts as a staging layer
- **Obfuscation:** Goto-based control flow obfuscation, octal/hex encoded strings, dynamic function construction
- **Primary C2:** `wertg-rewe[.]com/1.aspx` (obfuscated in octal encoding)
- **Secondary Payload Source:** PHP64/byphp64 path (second-stage loader)
- **Detection:** Goto-chain PHP patterns; octal string literals decoding to URLs; `eval()` of remotely fetched content
- **MITRE:** T1027.010 (Command Obfuscation), T1059.004 (PHP), T1105 (Ingress Tool Transfer)

---

### `wordfencetenp.php.sample` ‚Äî Malicious WordPress Plugin (Security Plugin Impersonator)
- **Type:** Malicious WordPress Plugin disguised as a Wordfence/Hostinger plugin
- **Capability:** Provides persistent backdoor access while appearing legitimate in the WordPress plugin list
- **Plugin Name (Fake):** "wordfencetenp" ‚Äî spoofs Wordfence branding
- **Persistence:** Survives plugin scans by appearing as a security tool
- **Detection:** Plugin name mismatch vs legitimate Wordfence plugin slug; unexpected `plugin_uri` pointing to hostinger.com; file hash mismatch against known-good Wordfence builds
- **MITRE:** T1505.003 (Web Shell), T1036.005 (Masquerading), T1546 (Event Triggered Execution)

---

### `lkdo11.php.sample`, `lkdo13.php.sample`, `lkdo14.php.sample`, `lkdo16.php.sample` ‚Äî Obfuscated Dropper Variants
- **Type:** PHP obfuscated dropper / stager (variant family)
- **Obfuscation:** Goto-based control flow obfuscation, hex/octal encoding, class-based architecture with randomized method names
- **Capability:** Fetch and execute second-stage payloads; likely used as initial access persistence after web shell deployment
- **Family Note:** `lkdo` variants appear to be iterative versions of the same dropper, likely updated to evade signature detection
- **Detection:** Goto-chain PHP; randomized class/method naming patterns; eval of decoded remote content

---

### `odcat17.php.sample`, `odcat18.php.sample`, `odcat19.php.sample`, `odcat110.php.sample` ‚Äî Obfuscated Dropper Variants
- **Type:** PHP obfuscated dropper / stager (variant family)
- **Obfuscation:** Similar to lkdo family ‚Äî goto-chains, hex encoding, dynamic function resolution
- **Family Note:** `odcat` variants appear to be a parallel dropper family potentially from a different threat actor or campaign
- **Detection:** Same detection logic as lkdo family; watch for overlapping C2 infrastructure

---

## Detection Resources

### YARA-Compatible Patterns to Hunt

```
// Web shell detection patterns
rule php_webshell_xshikata {
    strings:
        $s1 = "root@xshikata"
        $s2 = "create_wp_admin"
        $s3 = "xshikata_bkp"
        $s4 = "buat_token_cpanel"
    condition:
        any of them
}

rule php_goto_obfuscation {
    strings:
        $s1 = "goto " 
        $s2 = "eval(" 
        $s3 = "base64_decode"
        $s4 = "\\x" // hex encoding
    condition:
        3 of them and filesize < 500KB
}
```

### Network IOCs (Defanged)

```
5.9.228[.]188:5000       # Shadow C2 Panel
91.84.125[.]16           # Fake CAPTCHA PowerShell C2
wertg-rewe[.]com         # cleavable.php C2
stepmomhub[.]com         # cache.php mass-compromise receiver
```

---

## References

- [Fake CAPTCHA PowerShell Campaign Playbook](./fake-captcha-powershell-malware-91-84-125-16)
- [C2 Patterns Documentation](../../threat-infrastructure/c2-patterns/)
- [Shadow C2 Panel Analysis](../../threat-infrastructure/c2-patterns/Shadow%20C2%20Panel)
- MITRE ATT&CK: [T1505.003 ‚Äî Web Shell](https://attack.mitre.org/techniques/T1505/003/)
